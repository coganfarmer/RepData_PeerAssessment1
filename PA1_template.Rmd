---
title: "PA1_template.Rmd"
author: "Keven Howey"
date: "June 7, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## RMarkdown - Read Data into Variable PA1Data

```{r PA1}
if (!exists("PA1DATA")){
    PA1DATA <- read.csv("activity.csv")
}

```

## The data is aggregated by date and a histogram produced displaying the data. This histogram is devided into 20 segments.
```{r HistoGraph, echo=TRUE}
data <- aggregate(steps ~ date, data=PA1DATA, sum, na.rm = TRUE)
hist(data$steps, breaks=20, main="Total Steps per Day", xlab="Steps", ylab="Frequency")
```
## What is mean total number of steps taken per day?
## Calculating the mean and median of the aggregated steps per day is straightforward.
```{r mean1}
rawsteps_mean <- mean(PA1DATA$steps, na.rm=TRUE)
rawsteps_median <- median(PA1DATA$steps, na.rm=TRUE)
print(paste("The mean steps per day is: ", rawsteps_mean))
print(paste("The median steps per day is: ", rawsteps_median))
```
## What is the average daily activity pattern?
## To find the average daily activy pattern we aggregated the data on steps by the interval and took the mean. 
## This was then plotted into a graph where the pattern is easily determined. The maximum value, while easy to 
## find on the graph, is found numerically and displayed.
```{r SDATA}
sdata <- aggregate(steps ~ interval, data=PA1DATA, mean, na.rm=TRUE)
plot(sdata$interval, sdata$steps, type="l", main="Average Steps per Five Minute Interval",
     xlab="Interval No.", ylab="steps")
maxsteps <- max(sdata$steps)
print(paste("The maximum number of steps in a five minute interval was: ", maxsteps))
```
## Imputing missing values
## Eliminate NAs in the initial data set.
```{r ENAS}
missingdata <- sum(is.na(PA1DATA$steps))
print(paste("There are", missingdata, "missing data points."))
```
## Replaced all NAs with the median value. The mean and median of this revised data are then printed.
```{r RefinedData}
rdata <- PA1DATA
rdata$steps[is.na(rdata$steps)] <- median(PA1DATA$steps, na.rm=TRUE)
rdataday <- aggregate(steps ~ date, data=rdata, sum, na.rm=TRUE)
hist(rdataday$steps, breaks=20, main="Total Steps per Day \n Refined Data",
     xlab="Steps", ylab="Frequency")
bsteps_mean <- mean(rdata$steps)
bsteps_median <- median(rdata$steps)
print(paste("The mean is: ", bsteps_mean))
print(paste("The median is: ", bsteps_median))
```
## Are there differences in activity patterns between weekdays and weekends?
## In order to determine if there are activity differences, I plot two graphs, 
## one with weekday data and one with weekend data. 
## By plotting one above the other our x-axes are identical 
## enabling us to “eyeball” the graphs to note any differences.
```{r XX}
rdata$date <- as.Date(rdata$date)
rdata$dayname <- weekdays(rdata$date)
rdata$weekend <- as.factor(ifelse(rdata$dayname == "Saturday" |
                                 rdata$dayname == "Sunday", "Weekend", "Weekday"))
library(lattice)
plotdata <- aggregate(steps ~ interval + weekend, rdata, mean)
xyplot(steps ~ interval | factor(weekend), data=plotdata, aspect=1/3, type="l")
```